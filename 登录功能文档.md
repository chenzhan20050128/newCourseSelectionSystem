# 登录功能文档

## 功能概述

本系统实现了学生和教师的登录功能，支持用户身份验证和会话管理。

## 后端实现

### 1. 数据库设计

用户信息已包含在现有的数据库表中：

- **students 表**：存储学生信息
  - `student_id`: 学生ID（主键）
  - `student_name`: 学生姓名
  - `password`: 密码（MD5加密）
  - 其他字段：birth_date, college, phone

- **instructors 表**：存储教师信息
  - `instructor_id`: 教师ID（主键）
  - `instructor_name`: 教师姓名
  - `password`: 密码（MD5加密）
  - 其他字段：college

### 2. API 接口

#### 2.1 登录接口

**请求地址**: `POST /api/auth/login`

**请求参数**:
```json
{
  "username": "1",           // 学号/工号或姓名
  "password": "123456",      // 密码
  "userType": "student"      // 用户类型：student 或 instructor
}
```

**响应示例**:
```json
{
  "success": true,
  "message": "登录成功",
  "user": {
    "userId": 1,
    "username": "张三",
    "userType": "student",
    "college": "计算机学院",
    "phone": "13800138001"
  },
  "token": "a1b2c3d4e5f6..."
}
```

#### 2.2 登出接口

**请求地址**: `POST /api/auth/logout`

**响应**: `"登出成功"`

### 3. 核心类说明

#### 3.1 LoginRequest
- 位置: `application/request/LoginRequest.java`
- 功能: 登录请求参数封装

#### 3.2 LoginResponse
- 位置: `application/dto/LoginResponse.java`
- 功能: 登录响应数据封装

#### 3.3 UserDTO
- 位置: `application/dto/UserDTO.java`
- 功能: 用户信息数据传输对象

#### 3.4 AuthService（接口）
- 位置: `application/service/AuthService.java`
- 功能: 认证业务接口定义

#### 3.5 AuthServiceImpl（实现）
- 位置: `application/service/impl/AuthServiceImpl.java`
- 功能: 认证业务逻辑实现
  - 学生登录验证
  - 教师登录验证
  - 密码加密（MD5）
  - Token生成
  - 支持按ID或姓名查询用户

#### 3.6 AuthController
- 位置: `interfaces/AuthController.java`
- 功能: 认证接口控制器

## 前端实现

### 1. Login 组件

**位置**: `frontend/src/components/Login.vue`

**功能**:
- 用户登录表单
- 用户类型选择（学生/教师）
- 登录状态管理
- 错误信息提示

### 2. Auth API

**位置**: `frontend/src/api/authApi.js`

**功能**:
- 封装登录API调用
- 封装登出API调用

## 测试账号

系统已初始化以下测试账号（密码均为：123456）：

### 学生账号
| 学号 | 姓名 | 学院 | 密码 |
|------|------|------|------|
| 1001 | 张三 | 计算机学院 | 123456 |
| 1002 | 李四 | 软件学院 | 123456 |
| 1003 | 王五 | 信息学院 | 123456 |

### 教师账号
| 工号 | 姓名 | 学院 | 密码 |
|------|------|------|------|
| 2001 | 王教授 | 计算机学院 | 123456 |
| 2002 | 刘老师 | 软件学院 | 123456 |
| 2003 | 陈老师 | 信息学院 | 123456 |

## 使用说明

### 1. 数据库初始化

运行以下SQL脚本初始化测试用户：

```bash
mysql -u root -p ncss < backend/src/main/resources/sql/initUsers.sql
```

或者在数据库中手动执行该脚本。

### 2. 启动后端服务

```bash
cd backend
mvn spring-boot:run
```

后端服务将在 `http://localhost:8080` 启动。

### 3. 启动前端服务

```bash
cd frontend
npm install
npm run dev
```

前端服务将在 `http://localhost:5173` 启动。

### 4. 访问登录页面

在浏览器中访问 `http://localhost:5173/login` 即可看到登录页面。

## 安全说明

当前实现使用MD5进行密码加密，这是一个基础实现。在生产环境中，建议：

1. **使用更安全的加密算法**: 如BCrypt、Argon2等
2. **实现JWT Token**: 用于无状态的身份验证
3. **添加验证码**: 防止暴力破解
4. **实现Session管理**: 管理用户会话状态
5. **HTTPS**: 使用HTTPS协议保护数据传输

## 后续优化建议

1. **权限管理**: 实现基于角色的访问控制（RBAC）
2. **密码找回**: 添加忘记密码功能
3. **登录日志**: 记录用户登录历史
4. **多端登录限制**: 限制同一账号的并发登录
5. **Token刷新机制**: 实现自动刷新Token
6. **用户注册**: 添加新用户注册功能

## 依赖说明

后端新增依赖：
```xml
<dependency>
    <groupId>org.springframework.security</groupId>
    <artifactId>spring-security-crypto</artifactId>
</dependency>
```

该依赖用于后续升级密码加密算法（如BCrypt）。
