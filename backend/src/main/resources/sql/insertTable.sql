USE ncss;

-- 删除所有表中的数据（按外键依赖关系的逆序删除）
-- 先删除依赖其他表的子表数据
DELETE FROM enrollments;        -- 选课表（依赖students和courses）
DELETE FROM course_sessions;    -- 课程时间段表（依赖courses）
DELETE FROM courses;            -- 课程表
DELETE FROM elective_batches;   -- 选课轮次表
DELETE FROM students;           -- 学生表
DELETE FROM instructors;        -- 教师表

-- 1. 先插入 instructors（教师表）
INSERT INTO instructors (instructor_name, college, password) VALUES
-- 计算机学院
('李强', '计算机学院', 'pass123'),
('陈明', '计算机学院', 'pass124'),
('张伟', '计算机学院', 'pass125'),
-- 信息工程学院
('王老师', '信息工程学院', 'pass456'),
('刘芳', '信息工程学院', 'pass457'),
-- 数学学院
('赵敏', '数学学院', 'pass789'),
('周杰', '数学学院', 'pass790'),
-- 文学院
('王静', '文学院', 'pass101'),
('李明', '文学院', 'pass102'),
('张雅', '文学院', 'pass103'),
-- 历史学院
('陈建国', '历史学院', 'pass201'),
('刘文博', '历史学院', 'pass202'),
-- 哲学学院
('孙思邈', '哲学学院', 'pass301'),
('赵哲学', '哲学学院', 'pass302'),
-- 新闻传播学院
('马新闻', '新闻传播学院', 'pass401'),
('王传媒', '新闻传播学院', 'pass402'),
('李记者', '新闻传播学院', 'pass403'),
-- 法学院
('张正义', '法学院', 'pass501'),
('陈法理', '法学院', 'pass502'),
('刘律师', '法学院', 'pass503'),
-- 商学院
('王商业', '商学院', 'pass601'),
('李经济', '商学院', 'pass602'),
('赵管理', '商学院', 'pass603'),
('周会计', '商学院', 'pass604'),
-- 物理学院
('杨物理', '物理学院', 'pass701'),
('吴力学', '物理学院', 'pass702'),
-- 化学学院
('徐化学', '化学学院', 'pass801'),
('朱有机', '化学学院', 'pass802'),
-- 生命科学学院
('黄生物', '生命科学学院', 'pass901'),
('林遗传', '生命科学学院', 'pass902');

-- 2. 再插入 students（学生表）
INSERT INTO students (student_id, student_name, birth_date, college, password) VALUES
-- 计算机学院学生
(2022001, '张三', '2002-03-15', '计算机学院', 'stu123'),
(2022002, '张明', '2002-05-20', '计算机学院', 'stu124'),
(2022003, '李华', '2003-01-10', '计算机学院', 'stu125'),
(2022004, '王磊', '2002-08-15', '计算机学院', 'stu126'),
-- 数学学院学生
(2022005, '李四', '2001-07-21', '数学学院', 'stu456'),
(2022006, '陈数', '2002-02-14', '数学学院', 'stu457'),
(2022007, '刘学', '2003-06-30', '数学学院', 'stu458'),
-- 信息工程学院学生
(2022008, '王五', '2003-11-09', '信息工程学院', 'stu789'),
(2022009, '赵信', '2002-04-18', '信息工程学院', 'stu790'),
(2022010, '孙工', '2003-09-25', '信息工程学院', 'stu791'),
-- 文学院学生
(2022011, '文静', '2002-03-20', '文学院', 'stu101'),
(2022012, '诗雅', '2001-12-05', '文学院', 'stu102'),
(2022013, '书涵', '2003-07-15', '文学院', 'stu103'),
(2022014, '墨轩', '2002-11-22', '文学院', 'stu104'),
-- 历史学院学生
(2022015, '史明', '2001-09-10', '历史学院', 'stu201'),
(2022016, '古韵', '2002-05-28', '历史学院', 'stu202'),
(2022017, '传承', '2003-03-12', '历史学院', 'stu203'),
-- 哲学学院学生
(2022018, '思辨', '2001-10-15', '哲学学院', 'stu301'),
(2022019, '智慧', '2002-08-20', '哲学学院', 'stu302'),
(2022020, '真理', '2003-01-30', '哲学学院', 'stu303'),
-- 新闻传播学院学生
(2022021, '新闻', '2002-06-10', '新闻传播学院', 'stu401'),
(2022022, '传媒', '2001-11-25', '新闻传播学院', 'stu402'),
(2022023, '记者', '2003-04-18', '新闻传播学院', 'stu403'),
(2022024, '主播', '2002-09-12', '新闻传播学院', 'stu404'),
-- 法学院学生
(2022025, '法理', '2001-08-15', '法学院', 'stu501'),
(2022026, '正义', '2002-12-20', '法学院', 'stu502'),
(2022027, '律师', '2003-05-10', '法学院', 'stu503'),
(2022028, '法官', '2002-07-25', '法学院', 'stu504'),
-- 商学院学生
(2022029, '商学', '2001-09-18', '商学院', 'stu601'),
(2022030, '经济', '2002-03-22', '商学院', 'stu602'),
(2022031, '管理', '2003-10-05', '商学院', 'stu603'),
(2022032, '会计', '2002-06-15', '商学院', 'stu604'),
(2022033, '金融', '2001-12-28', '商学院', 'stu605'),
-- 物理学院学生
(2022034, '物理', '2002-04-10', '物理学院', 'stu701'),
(2022035, '力学', '2003-08-20', '物理学院', 'stu702'),
-- 化学学院学生
(2022036, '化学', '2002-05-15', '化学学院', 'stu801'),
(2022037, '有机', '2003-11-10', '化学学院', 'stu802'),
-- 生命科学学院学生
(2022038, '生物', '2002-07-20', '生命科学学院', 'stu901'),
(2022039, '遗传', '2003-02-14', '生命科学学院', 'stu902');

-- 3. 插入选课轮次数据
INSERT INTO elective_batches (batch_name, round_name, start_time, end_time, selection_mode, selection_strategy, status, description) VALUES
('2024-2025学年第一学期选课', '第一轮选课', '2024-09-01 08:00:00', '2024-09-05 23:59:59', '志愿选课', '按志愿优先级分配，志愿相同时随机抽签', '已结束', '第一轮选课采用志愿制，学生可填报多个志愿，系统将根据志愿优先级进行分配'),
('2024-2025学年第一学期选课', '第二轮选课', '2024-09-10 08:00:00', '2024-09-15 23:59:59', '即选即中', '选课后立即生效，先到先得', '已结束', '第二轮选课采用即选即中模式，选课成功后立即生效'),
('2024-2025学年第一学期选课', '补退选', '2024-09-20 08:00:00', '2024-09-25 23:59:59', '先到先得', '有余量即可选，无余量则排队等候', '已结束', '补退选阶段可以退选已选课程或选择仍有余量的课程'),
('2024-2025学年第二学期选课', '第一轮选课', '2025-12-05 08:00:00', '2025-12-10 23:59:59', '志愿选课', '按志愿优先级分配，志愿相同时随机抽签', '进行中', '第一轮选课采用志愿制，学生可填报多个志愿，系统将根据志愿优先级进行分配'),
('2024-2025学年第二学期选课', '第二轮选课', '2025-12-12 08:00:00', '2025-12-17 23:59:59', '即选即中', '选课后立即生效，先到先得', '未开始', '第二轮选课采用即选即中模式，选课成功后立即生效'),
('2024-2025学年第二学期选课', '补退选', '2025-12-20 08:00:00', '2025-12-25 23:59:59', '先到先得', '有余量即可选，无余量则排队等候', '未开始', '补退选阶段可以退选已选课程或选择仍有余量的课程');

-- 4. 插入 courses（课程表），包含type字段
INSERT INTO courses (course_name, credits, description, college, instructor_name, campus, classroom, start_week, end_week, capacity, enrolled_count, type) VALUES
('微积分I', 5, '微积分基础', '数学学院', '赵敏', '南校区', 'B203', 1, 16, 80, 10, '大学数学'),
('线性代数', 4, '线性空间与矩阵', '数学学院', '赵敏', '南校区', 'B101', 1, 16, 70, 8, '大学数学'),
('大学英语(一)', 4, '大学英语基础(一)', '外国语学院', '王英', '本部', 'E101', 1, 16, 100, 20, '大学英语'),
('形势与政策', 2, '时事政治理论课程', '马克思主义学院', '李政', '本部', 'Z101', 1, 8, 200, 60, '思政'),
('体育(一)', 1, '体育课程(一)', '体育学院', '张教练', '本部', 'T101', 1, 16, 120, 30, '大学体育'),
('软件工程', 3, '软件开发流程与方法', '计算机学院', '张伟', '本部', 'A206', 5, 16, 50, 2, '专业核心课程'),
('数据结构', 4, '基础数据结构课程', '计算机学院', '李强', '本部', 'A101', 1, 16, 60, 4, '学科基础课程'),
('人工智能导论', 3, 'AI基础', '计算机学院', '陈明', '本部', 'A204', 8, 16, 50, 1, '专业选修'),
('毕业论文(计算机)', 6, '毕业设计与论文', '计算机学院', '张伟', '本部', 'A999', 1, 20, 30, 0, '毕业论文');

-- 5. 插入 course_sessions（课程时间段表）
INSERT INTO course_sessions (course_id, weekday, start_period, end_period) VALUES
(1, '周一', 1, 2), (1, '周三', 4, 5),
(2, '周一', 3, 4), (2, '周三', 1, 3),
(3, '周二', 1, 2),
(4, '周三', 5, 6),
(5, '周四', 3, 4),
(6, '周二', 1, 3), (6, '周四', 1, 2),
(7, '周一', 1, 3),
(8, '周二', 5, 7);

-- 6. 插入 enrollments（选课表）
INSERT INTO enrollments (student_id, course_id, enrolled_at, final_grade, status) VALUES
(1, 1, '2024-02-20 09:00:00', 92.5, '已选'),
u(1, 6, '2024-02-20 10:00:00', NULL, '已选'),
(1, 7, '2024-02-20 11:00:00', 88.0, '已选'),
(2, 2, '2024-02-21 09:00:00', 85.5, '已选'),
(2, 3, '2024-02-21 10:00:00', 90.0, '已选');

-- ========================================
-- 更新所有用户密码为统一的测试密码
-- 密码：123456 (MD5加密后：e10adc3949ba59abbe56e057f20f883e)
-- ========================================

-- 更新所有学生密码为 123456
UPDATE students SET password = 'e10adc3949ba59abbe56e057f20f883e';

-- 更新所有教师密码为 123456
UPDATE instructors SET password = 'e10adc3949ba59abbe56e057f20f883e';

-- ========================================
-- 登录测试说明
-- ========================================
-- 学生登录：可使用学号或手机号
--   例如：student_id=40, phone=13800000001, password=123456
-- 教师登录：使用工号
--   例如：instructor_id=32, password=123456
-- ========================================